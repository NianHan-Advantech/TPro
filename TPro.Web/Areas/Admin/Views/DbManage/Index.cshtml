@{
    Layout = "~/Areas/Admin/Views/Shared/_layout.cshtml";
}
<el-container>
    <el-aside width="200px">
        <el-menu class="el-menu-vertical-demo" @@select="selectitem">
            <el-menu-item v-for="one,i in tableinfos" :key="i" :index="i.toString()">
                <template slot="title">
                    {{one.label}}
                </template>
            </el-menu-item>
        </el-menu>
    </el-aside>
    <el-main>
        <el-card>
            <div slot="header" class="clearfix">
                <el-button>添加</el-button>
            </div>
        </el-card>

        <el-form ref="form" :model="form" label-width="200px">
            <el-form-item :label="item.Name" v-for="item,i in objinfo" :key="i">
                <template v-if="item.Type=='String'">
                    <el-input v-model="item.Value"></el-input>
                </template>
                <template v-else-if="item.Type=='Boolean'">
                    <el-switch v-model="item.Value"
                               active-color="#13ce66"
                               inactive-color="#ff4949">
                    </el-switch>
                </template>
                <template v-else-if="item.Type=='Int32'">
                    <el-input-number v-model="item.Value" controls-position="right" :min="-1" :max="10"></el-input-number>
                </template>
                <template v-else>
                    无法识别的类型：{{item.Type}}
                </template>
            </el-form-item>
        </el-form>
    </el-main>
</el-container>

@section Scripts{
    <script>
        var mixin = {
            data() {
                return {
                    tableinfos: [],
                    objinfo: [],
                    form: {

                    }
                }
            },
            computed:{
                
            },
            mounted() {
                this.gettablenames();
            },
            methods: {
                gettablenames() {
                    axios.get("/admin/home/GetAllTableNames")
                        .then((res) => {
                            if (res.data.Code == 200) {
                                this.tableinfos = res.data.Data;
                            }
                        }).catch(err => console.error(err))
                        .finally()
                },
                isdisabled(item){

                },
                selectitem(index, path) {
                    console.log(index, this.tableinfos[index])
                    var nowtable = this.tableinfos[index].value;
                    axios.get("/admin/DbManage/GetTableInfo?fullname=" + nowtable)
                        .then((res) => {
                            console.log(res)
                            if (res.data.Code == 200) {
                                this.objinfo = res.data.Data;
                            }
                        }).catch(err => console.error(err))
                        .finally()
                },

            }
        }
    </script>
}
